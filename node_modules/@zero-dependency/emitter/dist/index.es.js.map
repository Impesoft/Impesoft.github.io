{"version":3,"file":"index.es.js","sources":["../src/emitter.ts"],"sourcesContent":["import type { EventMap, TypedEventEmitter } from './types.js'\n\nexport class Emitter<T extends EventMap> implements TypedEventEmitter<T> {\n  #events: Record<string | number | symbol, Function[]> = {}\n\n  on<E extends keyof T>(event: E, listener: T[E]): this {\n    const listeners = this.#events[event]\n    if (listeners) {\n      listeners.push(listener)\n    } else {\n      this.#events[event] = [listener]\n    }\n\n    return this\n  }\n\n  addListener<E extends keyof T>(event: E, listener: T[E]): this {\n    return this.on(event, listener)\n  }\n\n  once<E extends keyof T>(event: E, listener: T[E]): this {\n    const onceListener = (...args: any[]) => {\n      this.off(event, onceListener as T[E])\n      listener(...args)\n    }\n\n    this.on(event, onceListener as T[E])\n\n    return this\n  }\n\n  emit<E extends keyof T>(event: E, ...args: Parameters<T[E]>): boolean {\n    const listeners = this.#events[event] || []\n    for (let i = 0; i < listeners.length; i++) {\n      listeners[i]!(...args)\n    }\n\n    return Boolean(listeners.length)\n  }\n\n  off<E extends keyof T>(event: E, listener: T[E]): this {\n    if (this.#events[event]) {\n      this.#events[event] = this.#events[event].filter((v) => v !== listener)\n    }\n\n    return this\n  }\n\n  removeListener<E extends keyof T>(event: E, listener: T[E]): this {\n    return this.off(event, listener)\n  }\n\n  removeAllListeners<E extends keyof T>(event?: E): this {\n    if (event) {\n      delete this.#events[event]\n    } else {\n      this.#events = {}\n    }\n\n    return this\n  }\n\n  eventNames(): (string | symbol | keyof T)[] {\n    return Reflect.ownKeys(this.#events)\n  }\n\n  listeners<E extends keyof T>(event: E): T[E][] {\n    return this.#events[event] as T[E][]\n  }\n\n  listenerCount<E extends keyof T>(event: E): number {\n    return this.#events[event]?.length ?? 0\n  }\n}\n"],"names":["Emitter","#events","event","listener","listeners","onceListener","args","v"],"mappings":"AAEO,MAAMA,EAA4D;AAAA,EACvEC,KAAwD,CAAA;AAAA,EAExD,GAAsBC,GAAUC,GAAsB;AAC9C,UAAAC,IAAY,KAAKH,GAAQC;AAC/B,WAAIE,IACFA,EAAU,KAAKD,CAAQ,IAElB,KAAAF,GAAQC,KAAS,CAACC,CAAQ,GAG1B;AAAA,EACT;AAAA,EAEA,YAA+BD,GAAUC,GAAsB;AACtD,WAAA,KAAK,GAAGD,GAAOC,CAAQ;AAAA,EAChC;AAAA,EAEA,KAAwBD,GAAUC,GAAsB;AAChD,UAAAE,IAAe,IAAIC,MAAgB;AAClC,WAAA,IAAIJ,GAAOG,CAAoB,GACpCF,EAAS,GAAGG,CAAI;AAAA,IAAA;AAGb,gBAAA,GAAGJ,GAAOG,CAAoB,GAE5B;AAAA,EACT;AAAA,EAEA,KAAwBH,MAAaI,GAAiC;AACpE,UAAMF,IAAY,KAAKH,GAAQC,MAAU,CAAA;AACzC,aAAS,IAAI,GAAG,IAAIE,EAAU,QAAQ;AAC1B,MAAAA,EAAA,GAAI,GAAGE,CAAI;AAGhB,WAAA,QAAQF,EAAU,MAAM;AAAA,EACjC;AAAA,EAEA,IAAuBF,GAAUC,GAAsB;AACjD,WAAA,KAAKF,GAAQC,OACV,KAAAD,GAAQC,KAAS,KAAKD,GAAQC,GAAO,OAAO,CAACK,MAAMA,MAAMJ,CAAQ,IAGjE;AAAA,EACT;AAAA,EAEA,eAAkCD,GAAUC,GAAsB;AACzD,WAAA,KAAK,IAAID,GAAOC,CAAQ;AAAA,EACjC;AAAA,EAEA,mBAAsCD,GAAiB;AACrD,WAAIA,IACF,OAAO,KAAKD,GAAQC,KAEpB,KAAKD,KAAU,IAGV;AAAA,EACT;AAAA,EAEA,aAA4C;AACnC,WAAA,QAAQ,QAAQ,KAAKA,EAAO;AAAA,EACrC;AAAA,EAEA,UAA6BC,GAAkB;AAC7C,WAAO,KAAKD,GAAQC;AAAA,EACtB;AAAA,EAEA,cAAiCA,GAAkB;AAC1C,WAAA,KAAKD,GAAQC,IAAQ,UAAU;AAAA,EACxC;AACF;"}